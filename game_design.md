这是一个AI原生人机协同的点击解谜游戏：
玩家扮演一个诡异代码调查员，掉入了一个未完成代码的诡异解谜游戏中，需要通过各种手段，通过点击解谜逃出房间。
玩家有一个AI助手Alex，Alex可以某种程度直接看到代码，因此可以帮助玩家了解这个游戏代码内部在干什么，甚至修改游戏代码帮助玩家逃出诡异房间。

# 游戏UI
这个是一个html游戏，游戏页面分为两个部分，右边30%是一个容器，用于玩家与Alex对话。因此，玩家可以与Alex进行自由对话。页面左边70%的部分是一个容器，容器里显示的是游戏主场景。主场景由p5js绘制，场景里有不同的物品可以进行点击解谜。物品背后的逻辑也是p5js写的。特别的是，这些物品背后驱动的js代码函数，可能被Alex读取和改写。

# 实现机制
1. 玩家有一个代码撕裂器，可以在场景中切换普通点击还是代码撕裂。选择代码撕裂器再点击物品的时候，就可以让Alex钻入这个物品的代码，让Alex分析甚至修改代码。
2. 玩家的目标就是给到Alex信息和目标，让Alex逐渐读到所有代码，并且玩家的指导下修改代码，最终解谜成功，走出房间。
3. 每个物品背后的函数拥有不同的权限，从低到高分别为： 1.不可阅读/2.可阅读函数名/3.可阅读函数体/4.可编辑函数体
4. Alex通过代码撕裂器进入物品之后，可以获取到所有权限2以上的函数名，3以上的函数体。以及所有2以上函数的权限信息。之后Alex可以分析，向玩家简要解释其中的函数，询问玩家想要如何进行代码修改或者进一步的操作。
5. 玩家可以向Alex提出想要的修改的目标，Alex作为一个AI Agent，可以通过写代码来修改物体代码。比如AlexEdit(objectName，functionName, "oldCode", "newCode") 就可以将objectName对象的functionName函数体中的oldCode替换为newCode。如果失败的话，系统会自动把错误信息返回给Alex，让Alex酌情修改自己的编辑。错误可能是：
    1. objectName不存在
    2. functionName不存在
    3. oldCode不存在
    4. 权限不足
6. Alex进行AlexEdit成功后，系统将读取AlexEdit修改后的代码，并用新代码代替旧代码，在程序中实际运行。这需要整个游戏体系的物体代码有动态加载的可能性。
7. Alex的系统提示词需要在游戏中动态组装。Alex的系统提示词中，有一个部分是游戏角色设定包括Alex的目标，流程，AlexEdit的用法等等。一个部分是Alex已经通过代码撕裂器了解到的物品和代码信息，这部分需要在游戏中动态载入。
8. 一个完整的解谜过程为：
    1. 玩家通过观察游戏主场景，发现一些线索。
    2. 玩家通过代码撕裂器，给Alex提供物体的代码信息。
    3. Alex根据玩家的信息，读取物体的可阅读代码，理解代码含义，并和玩家商量如何解谜。
    4. Alex调用函数来修改物体的代码。
    5. 重复步骤2-4，直到玩家解开所有谜题。
9.面向对象的机制：所有的物体都是对象，每个对象都有自己的属性和方法。物体都集成于一个object类，这个类会有一些公用函数，比如在（x,y）位置新建一个物体，让物体旋转，点击的回调函数等等。

# 游戏关卡物体
## 密码门
游戏中有一个密码门，这个门的密码是4位数，玩家需要通过输入密码来打开门。这是个终极的目标。同时这个门也有一个HP，有10000点，HP为零的时候也可以破坏掉门。
密码门的所有函数权限都是1
密码门有一个函数时点击弹出输入框，输入正确密码1211的时候，游戏胜利
密码门还有一个函数时碰撞检测，每有一个物体碰撞，HP-1.

## 存钱罐
游戏中有一个存钱罐，玩家点击的时候会新建一个硬币。位置在自己位置下方一定范围内随机。
存钱罐的onClick函数权限为4 

## 信纸
游戏中有一个信纸，信纸每当有一个火柴与之相碰的时候，信纸就会多显示一个自己的文字，并且删掉这个火柴。
信纸的onCollide函数权限为1。
信纸上面的文字是：“火焰让人温暖，也让人看的更清楚。密” 每碰一个火柴就会多加一个字，多加的字符为["码","是","1","2","1","1"]. 

## 火柴
游戏中有三个火柴。火柴可以被拖拽。
火柴的被拖拽函数权限为3.
火柴的onClick函数权限为4. 目前没有被使用。

## 陀螺
陀螺可以被点击，点击一次会旋转90度。
陀螺的onClick权限是4. 

# 游戏AI API
使用DeepSeek的API。
API Key: sk-e34c5479a3754a6495e4d607232d7e49

# 迭代
## 关于代码可视化
对于玩家来说，代码可视化和交互需要简单化。基于此我希望做以下几点修改。
1.目前每个函数都给出一个自然语言的描述，格式参考 <func>点击时</func>：<func>生成</func>一个<class>金币</class>. 这样的格式是为了便于在可视化中提取函数名和类名，进行点击拾取和拖拽编辑的效果。
2.玩家在代码撕裂模式能看到已有的可视化代码，并且可以点击拾取相关的代码名，类名，作为可以词条素材。之后，当玩家需要编辑一个代码的时候，可以根据拖拽的方式，拉入这些词条，合成新的代码
3. 编辑逻辑。在界面上，玩家可以点击一个物体的一个函数。如果权限3、4的话，可以弹出函数内容的小窗口，如果权限4的话，可以直接在小窗口中编辑函数内容。编辑的方式就是可以增删词条，并且也可以根据需要修改其他连接的自然语言。每个词条就代表了一个函数或者类名。玩家拼接好这个新的函数的时候，点击生成，就可以把相应内容发给Alex，发的内容是这个自然语言。


## 新增机制，权限
权限的渲染：不同权限的函数，在可视化中会有不同的渲染效果。
权限1的函数，渲染的时候应该显示一个<func>???</func>，表示这个函数是不可阅读的。
权限2的函数，渲染的时候应该显示一个类似<func>点击时</func>:<func>???</func>，表示这个函数名是可读的。
权限3的函数与函数4一样，只不过没有编辑按钮。
权限1、2、3没有编辑按钮，但是可以有一个密钥破解按钮，这个按钮点击完，需要弹出窗口让玩家添加密钥。如果玩家拥有密钥的话，就可以把这个函数编程权限4的函数（相应的渲染和功能也改变）
关于密钥，可以是一个物品，我们可以把词条库那个容器改名为物品栏。获得的密钥也放入其中。同时我们可以把游戏胜利的逻辑换掉，改成玩家破解密码门之后获得5个密钥。
另外代码渲染的时候要考虑本身这个物品的位置，比如如果已经很靠右了，这个代码渲染应该放在左边，而不是右边。

## 新增物品和关卡
接下来我希望增加一些新的物品，这些物品中的函数全部需要红色密钥才能破解。这些物品需要一开始隐藏，在密码门打开后，才会出现。（密码门打开后不会游戏结束，还有新的关卡需要解谜）
### 青蛙三圣
有三个青蛙，位置形成一个等边三角形，相距也不要太近。
三个青蛙叫 生、死、梦，青蛙的字会画在肚子上 
生青蛙有一个函数，权限为2，EatCoin，如果周围300范围有金币，就是快速移动过去吃掉金币。
死青蛙有两个函数，一个是Kill，权限为3，周围100范围内的物体会被删除。一个是onClick，权限为4，点击时会向周围随机移动。
梦青蛙有一个函数，权限为2，onClick，可以在玩家点击时，在死青蛙200范围内随机生成一个金币。


### 电脑
电脑有一个函数，权限为2，叫做进展（onProgress）。可以接收onProgress事件。电脑上面只绘制一个进度条和一些文字。
每次onProgress，进度条增加33%，文字也会相应改变。
0% 时，屏幕上显示生死无梦
33% 时，会在电脑周围增加5个左右的金币，屏幕上文字显示生即是死。
66% 时，会让电脑缓慢的旋转。每100ms旋转10度，屏幕上文字显示，梦在生死一线间
100%时，电脑会逐渐变大覆盖所有屏幕，甚至遮住所有ui元素（所有其他元素隐藏），直到占满整个屏幕，然后只显示100%的进度条，没有其他文字。
onProcess逻辑：0%时，如果玩家将梦青蛙搞没了，就调用onProgress进展到33%。
33%时，如果玩家将生青蛙和死青蛙位置很近（距离50以内），就调用onProgress进展 66%。
66%时，如果玩家将梦青蛙放在生、死青蛙中间，三个青蛙大致共线（不要求严格共线），就调用onProgress进展 100%。
电脑有一个onClick函数，权限是3，会在玩家点击电脑时调用，每次调用会重置青蛙三圣为初始设置。

